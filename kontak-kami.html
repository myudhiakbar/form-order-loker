<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact Us By Lokerkesehatanid</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4/animate.min.css"/>
  <!-- <link rel="stylesheet" href="style.css"> -->
  <style>
    
  body {
    background: linear-gradient(135deg, #ece9e6, #ffffff);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    font-size: 18px;
  }

  .form-card {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    padding: 3rem 2.5rem;
    max-width: 500px;
    width: 100%;
    text-align: left;
  }

  h1 {
    font-size: 1.6rem;
    font-weight: 600;
    text-align: center;
    color: #333;
    margin: 0 0 0.5rem;
  }

  p {
    font-size: 0.9rem;
    text-align: center;
    color: #333;
    margin: 0 0 2rem;
  }

  input.form-control,
  textarea.form-control {
    padding: 0.6rem 1rem;      /* jarak teks ke tepi */
    border-radius: 5px;       /* sudut melengkung */
    border: 1.4px solid #ccc;
  }

  input.form-control {
    height: 2.5rem;              /* tinggi field uniform */
  }

  .btn {
    margin: 1rem 0;
    padding: 0.6rem 0;
  }

  .btn-primary {
    background: #4e73df;
    border: none;
    transition: all 0.3s ease;
  }

  .btn-primary:hover {
    background: #2e59d9;
    /* transform: translateY(-2px); */
  }

  footer {
      margin: 2.5rem 0 0;
      font-size: 1rem;
      text-align: center;
  }

  footer a {
      color: blue;
      text-decoration: none;
  }

  .wa-valid {
  color: #059705 !important;
  font-weight: 600;
  }

  .wa-invalid {
    color: #d90429 !important;
    font-weight: 600;
  }

  /* Responsive */
   /* Mobile */
  @media (max-width: 767px) {
      h1 { 
          font-size: 1.6rem;
      }

      p { 
          font-size: 1rem;
      }

      footer {
        font-size: 0.9rem;
      }
  }
  </style>
</head>

<body>
  <div class="form-card">
    <h1>Contact Us by Loker Kesehatan ID</h1>
    <p>Ada pertanyaan? Jangan ragu untuk menghubungi kami</p>
      <form id="contactForm">
        <div class="mb-3">
          <label for="nama" class="form-label">Nama <span class="text-danger">*</span></label>
          <input type="text" id="nama" name="nama" class="form-control" placeholder="" required>
        </div>

        <div class="mb-3">
          <label for="no_wa" class="form-label">Nomor WhatsApp <span class="text-danger">*</span></label>
          <input type="text" id="no_wa" name="no_wa" class="form-control" placeholder="" required>
          <small id="waCount" class="text-muted d-block mt-1"></small>
        </div>

        <div class="mb-3">
          <label for="isi_pesan" class="form-label">Isi Pesan <span class="text-danger">*</span></label>
          <textarea id="isi_pesan" name="isi_pesan" class="form-control" rows="4" placeholder="" required></textarea>
        </div>

        <button type="submit" id="submitBtn" class="btn btn-primary w-100">Kirim Pesan</button>
        <footer>
            <a href="https://link.loker-kesehatan.my.id">Loker Kesehatan ID</a> Â© 2018 - <span id="year"></span>
        </footer>
      </form>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- <script src="script.js"></script> -->
  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // === Form Submit Handling ===
    const scriptURL = "https://script.google.com/macros/s/AKfycbztu0VlT9aVNgqxLLm8e687FypkgYFPYUsqlThUH2R8d8sZNGg9P2Vn72dfSuYkWnc/exec";
    const ADMIN_WA = "6287713314496";

    const waInput = document.getElementById("no_wa");
    const waCount = document.getElementById("waCount");

    waInput.addEventListener("input", () => {
      waInput.value = waInput.value.replace(/\D/g, "");
      
      const onlyNumber = waInput.value.replace(/\D/g, "");
      waCount.textContent = `count : ` + `${onlyNumber.length} number`;

      // Reset class
      waCount.classList.remove("wa-valid", "wa-invalid");

      // Atur warna
      if (onlyNumber.length >= 10 && onlyNumber.length <= 13) {
        waCount.classList.add("wa-valid"); // valid
      } else {
        waCount.classList.add("wa-invalid"); // invalid
      }
    });

    document.getElementById("contactForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const form = e.target;
      const submitBtn = document.getElementById("submitBtn");
      const nama = form.nama.value.trim();
      const wa = form.no_wa.value.trim();
      const isiPesan = form.isi_pesan.value.trim();
      // === Tombol Loading Bootstrap ===
      submitBtn.disabled = true;
      submitBtn.innerHTML = `
        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        Mengirim...
      `;

      // === Validasi Wajib Diisi ===
      if (!nama || !wa || !isiPesan) {
        Swal.fire({
          icon: 'warning',
          title: 'Data belum lengkap!',
          text: 'Nama, Nomor WA dan Isi Pesan wajib diisi!',
          showClass: { popup: 'animate__animated animate__fadeInDown' },
          hideClass: { popup: 'animate__animated animate__fadeOutUp' }
        });
        
        submitBtn.disabled = false;
        submitBtn.innerHTML = `Kirim Pesan`;
        return;
      }

      // === Validasi PANJANG NOMOR WHATSAPP ===
      if (wa.length < 10 || wa.length > 13 || isNaN(wa)) {
        Swal.fire({
          icon: 'error',
          title: 'Nomor WA tidak valid!',
          text: 'Mohon masukkan nomor WA yang benar. Tanpa spasi/simbol.',
          showClass: { popup: 'animate__animated animate__fadeInDown' },
          hideClass: { popup: 'animate__animated animate__fadeOutUp' }
        });
        
        submitBtn.disabled = false;
        submitBtn.innerHTML = `Kirim Pesan`;
        return;
      }

      const data = {
        nama: nama,
        wa: wa,
        isiPesan: isiPesan,
      };

      try {
        const res = await fetch(scriptURL, {
          method: "POST",
          body: JSON.stringify(data),
        });

        const result = await res.json();

        if (result.result === "success") {
          const pesan = `Hai admin @lokerkesehatanid, nama saya : ${data.nama}\nno wa : ${data.wa}\n\nIsi pesan :\n${data.isiPesan}`;
          const pesanUrl = `https://wa.me/${ADMIN_WA}?text=${encodeURIComponent(pesan)}`;

          Swal.fire({
            icon: 'success',
            title: 'Pesan berhasil disimpan!',
            text: 'Klik tombol OK untuk kirim ke admin via WhatsApp',
            confirmButtonText: 'OK, kirim ke admin',
            showClass: { popup: 'animate__animated animate__fadeInDown' },
            hideClass: { popup: 'animate__animated animate__fadeOutUp' }
          }).then(() => {
            window.location.href = pesanUrl;
            form.reset();
          });

        } else {
          Swal.fire({
            icon: 'error',
            title: 'Gagal menyimpan pesan!',
            text: result.message,
            showClass: { popup: 'animate__animated animate__fadeInDown' },
            hideClass: { popup: 'animate__animated animate__fadeOutUp' }
          });
        }

      } catch (err) {
        Swal.fire({
          icon: 'error',
          title: 'Terjadi kesalahan!',
          text: err.message,
          showClass: { popup: 'animate__animated animate__fadeInDown' },
          hideClass: { popup: 'animate__animated animate__fadeOutUp' }
        });

      } finally {
        // === Reset tombol kembali normal ===
        submitBtn.disabled = false;
        submitBtn.innerHTML = `Kirim Pesan`;
      }
    });
  </script>
</body>
</html>
